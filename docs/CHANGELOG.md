# 📝 更新日志 (CHANGELOG)

本文档记录了BD2 MOD Packer项目的所有重要更改。

格式基于[Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循[语义化版本控制](https://semver.org/lang/zh-CN/)。

## [2.0.0] - 2025-08-16

### 🚀 重大架构更新

#### ✨ 新增功能
- **🏗️ 工作区集中化架构**: 全新的 `workspace/` 目录结构
  - `workspace/mod_projects/` - 统一管理所有MOD项目
  - `workspace/sourcedata/` - 原始游戏资源缓存
  - `workspace/targetdata/` - 处理后的MOD输出
  - 支持多作者、多项目的独立工作区管理

- **📦 Python包化重构**: 重新设计的 `bd2_mod_packer/` 模块架构
  - 采用标准Python包结构，支持 `pip install` 安装
  - 模块化设计：core、ui、config、utils、api 清晰分离
  - 入口点支持：安装后可直接使用 `bd2-mod-manager` 或 `bd2ab` 命令

- **🖥️ 双界面支持**: 命令行 + 控制台双模式
  - 新的 `main.py` 统一入口，支持命令行参数
  - 保留原有控制台界面，适应不同用户需求
  - 命令行模式：`--workspace`, `--list`, `--cleanup`, `--check`

- **⚙️ 统一配置系统**: 基于JSON的配置管理
  - 所有配置集中在 `config.json` 文件
  - 配置热重载，修改后立即生效
  - 工作区配置自动管理：`mod_workspaces` 数组

- **📊 智能工作区管理**: 
  - 自动创建和删除工作区
  - 智能文件统计和变更检测
  - 时间戳输出目录，避免文件覆盖

#### 🔧 改进功能
- **模块化重构**: 完全重构代码架构
  - `BD2ModManager` - 核心管理器，协调所有业务逻辑
  - `BD2Config` - 配置管理器，统一处理所有配置
  - `BD2Console` - 控制台界面，优化用户交互体验
  - 统一错误处理和日志记录

- **工作流程优化**:
  - 简化用户操作流程，减少学习成本
  - 智能路径管理，自动处理目录创建
  - 备用模式支持，确保基本功能始终可用

- **兼容性保障**:
  - 保留旧版本文件的兼容性支持
  - 平滑迁移路径，用户可逐步适应新架构
  - 保持现有MOD文件的完整性

#### 🐛 修复问题
- 修复多工作区下的文件冲突问题
- 解决模块导入错误和循环依赖问题
- 优化内存使用，提高大文件处理性能
- 改善网络错误处理和重试机制

### 🔄 迁移说明

从 v1.x 迁移到 v2.0：

1. **工作区迁移**: 原 `replace/` 目录现在位于 `workspace/mod_projects/replace/`
2. **配置迁移**: 所有配置现在集中在 `config.json` 文件
3. **启动方式**: 使用 `python main.py` 而不是 `cd src && python console.py`
4. **多工作区**: 现在可以创建多个独立的MOD工作区

## [1.2.0] - 2025-08-15

### ✨ 新增
- **统一控制台系统**: 全新的用户友好界面
  - 菜单驱动操作，无需记忆命令
  - 美观的ASCII艺术界面
  - 智能错误处理和用户反馈
- **依赖环境检查功能**: 一键检查Python环境
  - 自动检测所有依赖库安装状态
  - 显示详细版本信息
  - 提供修复建议和快速安装命令
  - 支持国内镜像源加速下载
- **配置管理系统**: 完整的配置管理解决方案
  - JSON配置文件自动生成
  - 可视化配置修改工具
  - 配置热重载支持
  - 代理设置统一管理

### 🔧 改进
- **模块化重构**: 彻底重构代码架构
  - 统一配置系统替代硬编码设置
  - 单例模式配置管理
  - 模块间依赖解耦
- **网络模块优化**:
  - 所有网络请求使用统一代理配置
  - 智能重试和错误恢复机制
  - 超时设置可配置化
- **用户体验提升**:
  - 详细的进度显示
  - 彩色输出和图标提示
  - 完善的错误信息和修复建议

## [1.1.0] - 2025-08-10

### ✨ 新增
- Unity AssetBundle 完整支持
- 多线程下载和处理
- 智能缓存机制
- 详细的处理日志

### 🔧 改进
- 优化内存使用
- 提高处理速度
- 增强错误处理
- 改善用户体验

## [1.0.0] - 2025-08-01

### ✨ 初版发布
- Google Sheets 角色数据自动获取
- 标准化目录结构生成
- BD2 CDN 资源下载
- 基础MOD打包功能
- Unity资源处理基础支持

---

## 版本命名规则

- **主版本号**: 重大架构变更，不向后兼容
- **次版本号**: 新功能添加，向后兼容
- **修订版本号**: Bug修复和小改进

## 发布周期

- **主版本**: 根据需要发布，通常包含重大架构变更
- **次版本**: 每月发布，包含新功能和改进
- **修订版本**: 每周发布，主要修复Bug和优化
  - 友好的错误信息
  - 交互式操作确认
- **开发者体验**:
  - 完善的测试套件
  - 代码文档和注释
  - 调试工具和日志系统

### 🐛 修复
- 修复硬编码代理设置导致的配置困难
- 解决网络超时设置不一致问题
- 修复配置文件缺失时的启动错误
- 改进错误处理和异常恢复机制

## [1.1.0] - 2025-08-14

### ✨ 新增
- **目录初始化系统**: 自动角色目录创建
  - Google Sheets数据抓取
  - 标准化目录结构生成
  - 增量更新支持
  - 智能跳过已存在目录
- **任务状态管理**: 完整的任务执行状态跟踪
  - 文件变更检测
  - 处理状态持久化
  - 版本控制和冲突检测
- **数据缓存系统**: 
  - 本地数据缓存
  - 离线模式支持
  - 数据完整性验证

### 🔧 改进
- **Unity资源处理优化**:
  - 提升处理性能
  - 支持更多纹理格式
  - 错误恢复机制
- **网络请求稳定性**:
  - 添加重试机制
  - 超时处理优化
  - 代理支持改进

### 🐛 修复
- 修复Unity Bundle读取异常
- 解决大文件下载超时问题
- 修复字符编码问题

## [1.0.0] - 2025-08-13

### ✨ 新增
- **核心MOD打包功能**: 基础的MOD资源替换和打包
  - Unity AssetBundle处理
  - 纹理替换支持
  - 自动README生成
- **BD2 CDN API**: 游戏资源获取接口
  - 版本信息获取
  - 资源文件下载
  - Protobuf数据解析
- **基础架构**:
  - Python项目结构
  - 依赖管理系统
  - 日志记录功能

### 🔧 技术栈
- **Python 3.8+**: 主要开发语言
- **UnityPy**: Unity资源处理核心库
- **Requests**: HTTP网络请求
- **BeautifulSoup**: HTML数据解析
- **Pillow**: 图像处理
- **blackboxprotobuf**: Protobuf数据解析

---

## 📊 版本统计

- **总版本数**: 3个主要版本
- **功能特性**: 20+ 核心功能
- **依赖库**: 7个核心依赖
- **代码行数**: 2000+ 行
- **文档页面**: 5个主要文档

## 🚀 下个版本预览 (v1.3.0)

### 计划功能
- **GUI图形界面**: 基于tkinter的桌面应用
- **批量处理**: 支持多MOD同时处理
- **云端同步**: 配置和数据云端备份
- **插件系统**: 第三方扩展支持
- **性能监控**: 处理性能分析和优化

### 技术改进
- **异步处理**: 提升并发处理能力
- **内存优化**: 减少大文件处理内存占用
- **错误追踪**: 详细的错误报告和分析
- **自动更新**: 程序自动更新检查

---

## 💝 贡献者

感谢所有为项目做出贡献的开发者：

- **oldnew** - 项目创始人和主要开发者
- **GitHub Copilot** - AI编程助手，代码优化和文档编写

## 📞 技术支持

如果您在使用过程中遇到问题：

1. **查看文档**: 首先查阅README.md和相关文档
2. **检查Issues**: 查看是否有相同问题的解决方案
3. **提交问题**: 详细描述问题并提供错误日志
4. **社区讨论**: 在Discussions中与其他用户交流

---

*更新日志持续更新中...*
